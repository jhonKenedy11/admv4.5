########## 11-JUNHO-2025 IMPLEMENTACAO DE NFS - JHON

CREATE TABLE EST_NOTA_FISCAL_SERVICO (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    IDENTIFICADOR_ARQUIVO VARCHAR(80) NULL UNIQUE,
    NUMERO INT NULL,
    SERIE INT NULL,
    DATA_EMISSAO DATE NULL,
    HORA_EMISSAO TIME NULL,
    COD_VERIFICADOR_AUTENTICIDADE VARCHAR(16) NULL,
    LINK_NFSE VARCHAR(500) NULL,
    SITUACAO INT(1) NULL COMMENT "1-Emitida / 2-Cancelada",
    RPS_NUMERO VARCHAR(9) NULL,
    RPS_SERIE VARCHAR(2) NULL,
    RPS_DATA_EMISSAO DATE NULL,
    RPS_HORA_EMISSAO TIME NULL,
    COD_EQUIPAMENTO_AUTOMATICO VARCHAR(100) NULL,
    DATA_FATO_GERADOR DATE NULL,
    OBSERVACAO VARCHAR(1000) NULL,
    VALOR_TOTAL DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_DESCONTO DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_IR DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_INSS DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_CONTRIBUICAO_SOCIAL DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_RPS_RETENCAO DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_PIS DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_COFINS DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    PRESTADOR_CPFCNPJ VARCHAR(14) NULL,
    PRESTADOR_CIDADE_CODIGO INT NULL,
    TOMADOR_ID INT NOT NULL,
    TOMADOR_CPFCNPJ VARCHAR(14) NULL,
    TOMADOR_TIPO CHAR(1) NULL COMMENT "F-Física / J-Jurídica / E-Estrangeiro",
    TOMADOR_NOME_RAZAO_SOCIAL VARCHAR(100) NULL,
    TOMADOR_NOME_FANTASIA VARCHAR(100) NULL,
    TOMADOR_IE VARCHAR(16) NULL,
    TOMADOR_EMAIL VARCHAR(100) NULL,
    TOMADOR_ENDERECO_INFORMADO CHAR(1) NULL COMMENT "1-Sim / 0-Não",
    TOMADOR_LOGRADOURO VARCHAR(70) NULL,
    TOMADOR_NUMERO_RESIDENCIA VARCHAR(8) NULL,
    TOMADOR_COMPLEMENTO VARCHAR(50) NULL,
    TOMADOR_BAIRRO VARCHAR(30) NULL,
    TOMADOR_CIDADE_CODIGO VARCHAR(100) NULL,
    TOMADOR_CEP VARCHAR(8) NULL,
    TOMADOR_PONTO_REFERENCIA VARCHAR(100) NULL,
    TOMADOR_DDD_FONE_COMERCIAL VARCHAR(3) NULL,
    TOMADOR_FONE_COMERCIAL VARCHAR(9) NULL,
    TOMADOR_DDD_FONE_RESIDENCIAL VARCHAR(3) NULL,
    TOMADOR_FONE_RESIDENCIAL VARCHAR(9) NULL,
    TOMADOR_DDD_FAX VARCHAR(3) NULL,
    TOMADOR_FONE_FAX VARCHAR(9) NULL,
    TOMADOR_IDENTIFICADOR_ESTRANGEIRO VARCHAR(20) NULL,
    TOMADOR_ESTADO_ESTRANGEIRO VARCHAR(100) NULL,
    TOMADOR_PAIS_ESTRANGEIRO VARCHAR(100) NULL,
    PRODUTOS_DESCRICAO VARCHAR(200) NULL COMMENT "Tudo que se quer que saia na nota a respeito dos produtos",
    PRODUTOS_VALOR_TOTAL DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    FORMA_PAGAMENTO_TIPO INT NULL COMMENT "1-À vista / 2-A prazo / 3-Na Apresentação / 4-Cartão de Débito / 5-Cartão de Crédito",
    CREATED_USER INT NOT NULL,
    CREATED_AT TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_USER INT NULL,
    UPDATED_AT TIMESTAMP NULL ON UPDATE CURRENT_TIMESTAMP
);


CREATE TABLE EST_NOTA_FISCAL_SERVICO_ITEM (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_NOTA_FISCAL_SERVICO INT NOT NULL,
    ID_CAT_SERVICO INT NOT NULL,
    TRIBUTA_MUNICIPIO_PRESTADOR CHAR(1) COMMENT "1-Sim (tributação ocorre no município do prestador) / 0-Não (tributação ocorre no local da prestação do serviço)",
    CODIGO_LOCAL_PRESTACAO_SERVICO INT,
    CODIGO_ITEM_LISTA_SERVICO VARCHAR(9),
    DESCRITIVO VARCHAR(1000),
    ALIQUOTA DECIMAL(5, 2) NOT NULL DEFAULT 0.00,
    SITUACAO_TRIBUTARIA INT,
    VALOR_TRIBUTAVEL DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    VALOR_DEDUCAO DECIMAL(15, 2) NOT NULL DEFAULT 0.00 ,
    VALOR_ISSRF DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    UNIDADE_CODIGO INT,
    UNIDADE_QUANTIDADE DECIMAL(15, 2),
    UNIDADE_VALOR_UNITARIO DECIMAL(15, 2) NOT NULL DEFAULT 0.00,
    CREATED_USER INT NOT NULL,
    CREATED_AT TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_USER INT NULL,
    UPDATED_AT TIMESTAMP NULL ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (ID_NOTA_FISCAL_SERVICO) REFERENCES EST_NOTA_FISCAL_SERVICO(ID),
    FOREIGN KEY (ID_CAT_SERVICO) REFERENCES CAT_SERVICO(ID)
);
